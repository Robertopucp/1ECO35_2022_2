percent_gp5, percent_gp6, percent_gp7, percent_gp8)
data <- data %>% mutate(ubigeo = paste(CCDD,CCPP,CCDI, sep = "" )) %>%
filter(ubigeo %in% dist_vraem) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0)
) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100
) %>%
select(percent_gp1, percent_gp2, percent_gp3, percent_gp4,
percent_gp5, percent_gp6, percent_gp7, percent_gp8)
View(data)
names(vraem.shapefile)
data <- bind_rows(apur, ayac, cusco, huanc, junin)
data <- data %>% mutate(ubigeo = paste(CCDD,CCPP,CCDI, sep = "" ))
data <- merge(data, vraem.shapefile[, c("UBIGEO", "NOMAMBITO")] ,
by.x = c("ubigeo"), by.y = c("UBIGEO"))
View(data)
data$NOMAMBITO
unique(data$NOMAMBITO)
data <- data %>% filter(ubigeo %in% dist_vraem,
NOMAMBITO %in% c("AMBITO DE INTERVENCION DIRECTA",
"AMBITO DE INFLUENCIA")) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0)
)  %>%  group_by(NOMAMBITO) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100
) %>%
select(percent_gp1, percent_gp2, percent_gp3, percent_gp4,
percent_gp5, percent_gp6, percent_gp7, percent_gp8)
View(data)
data <- bind_rows(apur, ayac, cusco, huanc, junin)
data <- data %>% mutate(ubigeo = paste(CCDD,CCPP,CCDI, sep = "" ))
######## Load VRAEM districs #############
vraem.shapefile <- read_sf('Georeferenciación VRAEM/shapefile/distrito/distrito_0Qp8dHX.shp')
dist_vraem <- vraem.shapefile$UBIGEO
print(dist_vraem)
names(vraem.shapefile)
data <- merge(data, vraem.shapefile[, c("UBIGEO", "NOMAMBITO")] ,
by.x = c("ubigeo"), by.y = c("UBIGEO"))
unique(data$NOMAMBITO)
#---------------------------------------#
# Grupos de edad
#........................................#
#dist <- dist_vraem[grepl("^0(3|5|8|9|12)",dist_vraem)]
data_sum <- data %>% filter(ubigeo %in% dist_vraem,
NOMAMBITO %in% c("AMBITO DE INTERVENCION DIRECTA",
"AMBITO DE INFLUENCIA")) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0)
)  %>%  group_by(NOMAMBITO) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100
) %>%
select(NOMAMBITO, percent_gp1, percent_gp2, percent_gp3, percent_gp4,
percent_gp5, percent_gp6, percent_gp7, percent_gp8)
View(data_sum)
xtable(apur_edad)
xtable(data_sum)
View(data)
data$C5_P13_NIV %>% attr('labels') # value labels
data <- bind_rows(apur, ayac, cusco, huanc, junin)
data <- data %>% mutate(ubigeo = paste(CCDD,CCPP,CCDI, sep = "" ))
data$C5_P13_NIV %>% attr('labels') # value labels
######## Load VRAEM districs #############
vraem.shapefile <- read_sf('Georeferenciación VRAEM/shapefile/distrito/distrito_0Qp8dHX.shp')
dist_vraem <- vraem.shapefile$UBIGEO
print(dist_vraem)
names(vraem.shapefile)
data <- merge(data, vraem.shapefile[, c("UBIGEO", "NOMAMBITO")] ,
by.x = c("ubigeo"), by.y = c("UBIGEO"))
unique(data$NOMAMBITO)
#---------------------------------------#
# Grupos de edad
#........................................#
#dist <- dist_vraem[grepl("^0(3|5|8|9|12)",dist_vraem)]
data_sum <- data %>% filter(ubigeo %in% dist_vraem,
NOMAMBITO %in% c("AMBITO DE INTERVENCION DIRECTA",
"AMBITO DE INFLUENCIA")) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0),
g3_sec = ifelse(C5_P13_NIV == 4 & g3 == 1,1,0),
g3_sup_in = ifelse(C5_P13_NIV == 6 & g3 == 1,1,0),
g3_sup_co = ifelse(C5_P13_NIV == 7 & g3 == 1,1,0),
g3_uni_in = ifelse(C5_P13_NIV == 8 & g3 == 1,1,0),
g3_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g3 == 1,1,0),
g4_sec = ifelse(C5_P13_NIV == 4 & g4 == 1,1,0),
g4_sup_in = ifelse(C5_P13_NIV == 6 & g4 == 1,1,0),
g4_sup_co = ifelse(C5_P13_NIV == 7 & g4 == 1,1,0),
g4_uni_in = ifelse(C5_P13_NIV == 8 & g4 == 1,1,0),
g4_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10)  & g4 == 1,1,0),
g5_sec = ifelse(C5_P13_NIV == 4 & g5 == 1,1,0),
g5_sup_in = ifelse(C5_P13_NIV == 6 & g5 == 1,1,0),
g5_sup_co = ifelse(C5_P13_NIV == 7 & g5 == 1,1,0),
g5_uni_in = ifelse(C5_P13_NIV == 8 & g5 == 1,1,0),
g5_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g5 == 1,1,0),
classification = case_when(substr(C5_P19_COD, 1, 1) %in% c("1","2") ~ 0,
substr(C5_P19_COD, 1, 1) %in% c("3","4","5","6","7","8","9") ~ 1,
substr(C5_P19_COD, 1, 2) %in% c("01") ~ 0,
substr(C5_P19_COD, 1, 2) %in% c("02", "03")  ~ 1),
g3_bluecollar =  ifelse(classification == 1 & g3 == 1,1,0),
g4_bluecollar =  ifelse(classification == 1 & g4 == 1,1,0),
g5_bluecollar =  ifelse(classification == 1 & g5 == 1,1,0),
)  %>%  group_by(NOMAMBITO) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8),
g3_sec = sum(g3_sec), g3_sup_in = sum(g3_sup_in), g3_sup_co = sum(g3_sup_co),
g3_uni_in = sum(g3_uni_in), g3_uni_co = sum(g3_uni_co),
g4_sec = sum(g4_sec), g4_sup_in = sum(g4_sup_in), g4_sup_co = sum(g4_sup_co),
g4_uni_in = sum(g4_uni_in), g4_uni_co = sum(g4_uni_co),
g5_sec = sum(g5_sec), g5_sup_in = sum(g5_sup_in), g5_sup_co = sum(g5_sup_co),
g5_uni_in = sum(g5_uni_in), g5_uni_co = sum(g5_uni_co),
g3_bluecollar = sum( g3_bluecollar),  g4_bluecollar = sum( g4_bluecollar),
g5_bluecollar = sum( g5_bluecollar)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100,
g3_sec = (g3_sec/gp3)*100, g3_sup_in = (g3_sup_in/gp3)*100, g3_sup_co = (g3_sup_co/gp3)*100,
g3_uni_in = g3_uni_in/gp3, g3_uni_co = g3_uni_co/gp3,
g4_sec = (g4_sec/gp4)*100, g4_sup_in = (g4_sup_in/gp4)*100, g4_sup_co = (g4_sup_co/gp4)*100,
g4_uni_in = g4_uni_in/gp4 , g4_uni_co = g4_uni_co/gp4,
g5_sec = (g5_sec/gp5)*100, g5_sup_in = (g5_sup_in/gp5)*100, g5_sup_co = (g5_sup_co/gp5)*100,
g5_uni_in = (g5_uni_in/gp5)*100, g5_uni_co = (g5_uni_co/gp5)*100,
g3_bluecollar = (g3_bluecollar/gp3)*100, (g4_bluecollar/gp4)*100,
(g5_bluecollar/gp5)*100
)
View(data_sum)
data_sum <- data %>% filter(ubigeo %in% dist_vraem,
NOMAMBITO %in% c("AMBITO DE INTERVENCION DIRECTA",
"AMBITO DE INFLUENCIA")) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0),
g3_sec = ifelse(C5_P13_NIV == 4 & g3 == 1,1,0),
g3_sup_in = ifelse(C5_P13_NIV == 6 & g3 == 1,1,0),
g3_sup_co = ifelse(C5_P13_NIV == 7 & g3 == 1,1,0),
g3_uni_in = ifelse(C5_P13_NIV == 8 & g3 == 1,1,0),
g3_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g3 == 1,1,0),
g4_sec = ifelse(C5_P13_NIV == 4 & g4 == 1,1,0),
g4_sup_in = ifelse(C5_P13_NIV == 6 & g4 == 1,1,0),
g4_sup_co = ifelse(C5_P13_NIV == 7 & g4 == 1,1,0),
g4_uni_in = ifelse(C5_P13_NIV == 8 & g4 == 1,1,0),
g4_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10)  & g4 == 1,1,0),
g5_sec = ifelse(C5_P13_NIV == 4 & g5 == 1,1,0),
g5_sup_in = ifelse(C5_P13_NIV == 6 & g5 == 1,1,0),
g5_sup_co = ifelse(C5_P13_NIV == 7 & g5 == 1,1,0),
g5_uni_in = ifelse(C5_P13_NIV == 8 & g5 == 1,1,0),
g5_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g5 == 1,1,0),
classification = case_when(substr(C5_P19_COD, 1, 1) %in% c("1","2") ~ 0,
substr(C5_P19_COD, 1, 1) %in% c("3","4","5","6","7","8","9") ~ 1,
substr(C5_P19_COD, 1, 2) %in% c("01") ~ 0,
substr(C5_P19_COD, 1, 2) %in% c("02", "03")  ~ 1),
g3_bluecollar =  ifelse(classification == 1 & g3 == 1,1,0),
g4_bluecollar =  ifelse(classification == 1 & g4 == 1,1,0),
g5_bluecollar =  ifelse(classification == 1 & g5 == 1,1,0),
)  %>%  group_by(NOMAMBITO) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8),
g3_sec = sum(g3_sec), g3_sup_in = sum(g3_sup_in), g3_sup_co = sum(g3_sup_co),
g3_uni_in = sum(g3_uni_in), g3_uni_co = sum(g3_uni_co),
g4_sec = sum(g4_sec), g4_sup_in = sum(g4_sup_in), g4_sup_co = sum(g4_sup_co),
g4_uni_in = sum(g4_uni_in), g4_uni_co = sum(g4_uni_co),
g5_sec = sum(g5_sec), g5_sup_in = sum(g5_sup_in), g5_sup_co = sum(g5_sup_co),
g5_uni_in = sum(g5_uni_in), g5_uni_co = sum(g5_uni_co),
g3_bluecollar = sum( g3_bluecollar,na.rm=TRUE),
g4_bluecollar = sum( g4_bluecollar,na.rm=TRUE),
g5_bluecollar = sum( g5_bluecollar,na.rm=TRUE)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100,
g3_sec = (g3_sec/gp3)*100, g3_sup_in = (g3_sup_in/gp3)*100, g3_sup_co = (g3_sup_co/gp3)*100,
g3_uni_in = g3_uni_in/gp3, g3_uni_co = g3_uni_co/gp3,
g4_sec = (g4_sec/gp4)*100, g4_sup_in = (g4_sup_in/gp4)*100, g4_sup_co = (g4_sup_co/gp4)*100,
g4_uni_in = g4_uni_in/gp4 , g4_uni_co = g4_uni_co/gp4,
g5_sec = (g5_sec/gp5)*100, g5_sup_in = (g5_sup_in/gp5)*100, g5_sup_co = (g5_sup_co/gp5)*100,
g5_uni_in = (g5_uni_in/gp5)*100, g5_uni_co = (g5_uni_co/gp5)*100,
g3_bluecollar = (g3_bluecollar/gp3)*100, (g4_bluecollar/gp4)*100,
(g5_bluecollar/gp5)*100
)
View(data_sum)
data_sum <- data %>% filter(ubigeo %in% dist_vraem,
NOMAMBITO %in% c("AMBITO DE INTERVENCION DIRECTA",
"AMBITO DE INFLUENCIA")) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0),
g3_sec = ifelse(C5_P13_NIV == 4 & g3 == 1,1,0),
g3_sup_in = ifelse(C5_P13_NIV == 6 & g3 == 1,1,0),
g3_sup_co = ifelse(C5_P13_NIV == 7 & g3 == 1,1,0),
g3_uni_in = ifelse(C5_P13_NIV == 8 & g3 == 1,1,0),
g3_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g3 == 1,1,0),
g4_sec = ifelse(C5_P13_NIV == 4 & g4 == 1,1,0),
g4_sup_in = ifelse(C5_P13_NIV == 6 & g4 == 1,1,0),
g4_sup_co = ifelse(C5_P13_NIV == 7 & g4 == 1,1,0),
g4_uni_in = ifelse(C5_P13_NIV == 8 & g4 == 1,1,0),
g4_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10)  & g4 == 1,1,0),
g5_sec = ifelse(C5_P13_NIV == 4 & g5 == 1,1,0),
g5_sup_in = ifelse(C5_P13_NIV == 6 & g5 == 1,1,0),
g5_sup_co = ifelse(C5_P13_NIV == 7 & g5 == 1,1,0),
g5_uni_in = ifelse(C5_P13_NIV == 8 & g5 == 1,1,0),
g5_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g5 == 1,1,0),
classification = case_when(substr(C5_P19_COD, 1, 1) %in% c("1","2") ~ 0,
substr(C5_P19_COD, 1, 1) %in% c("3","4","5","6","7","8","9") ~ 1,
substr(C5_P19_COD, 1, 2) %in% c("01") ~ 0,
substr(C5_P19_COD, 1, 2) %in% c("02", "03")  ~ 1),
g3_bluecollar =  ifelse(classification == 1 & g3 == 1,1,0),
g4_bluecollar =  ifelse(classification == 1 & g4 == 1,1,0),
g5_bluecollar =  ifelse(classification == 1 & g5 == 1,1,0),
)  %>%  group_by(NOMAMBITO) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8),
g3_sec = sum(g3_sec), g3_sup_in = sum(g3_sup_in), g3_sup_co = sum(g3_sup_co),
g3_uni_in = sum(g3_uni_in), g3_uni_co = sum(g3_uni_co),
g4_sec = sum(g4_sec), g4_sup_in = sum(g4_sup_in), g4_sup_co = sum(g4_sup_co),
g4_uni_in = sum(g4_uni_in), g4_uni_co = sum(g4_uni_co),
g5_sec = sum(g5_sec), g5_sup_in = sum(g5_sup_in), g5_sup_co = sum(g5_sup_co),
g5_uni_in = sum(g5_uni_in), g5_uni_co = sum(g5_uni_co),
g3_bluecollar = sum( g3_bluecollar,na.rm=TRUE),
g4_bluecollar = sum( g4_bluecollar,na.rm=TRUE),
g5_bluecollar = sum( g5_bluecollar,na.rm=TRUE)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100,
g3_sec = (g3_sec/gp3)*100, g3_sup_in = (g3_sup_in/gp3)*100, g3_sup_co = (g3_sup_co/gp3)*100,
g3_uni_in = g3_uni_in/gp3, g3_uni_co = g3_uni_co/gp3,
g4_sec = (g4_sec/gp4)*100, g4_sup_in = (g4_sup_in/gp4)*100, g4_sup_co = (g4_sup_co/gp4)*100,
g4_uni_in = g4_uni_in/gp4 , g4_uni_co = g4_uni_co/gp4,
g5_sec = (g5_sec/gp5)*100, g5_sup_in = (g5_sup_in/gp5)*100, g5_sup_co = (g5_sup_co/gp5)*100,
g5_uni_in = (g5_uni_in/gp5)*100, g5_uni_co = (g5_uni_co/gp5)*100,
g3_bluecollar = (g3_bluecollar/gp3)*100, g4_bluecollar = (g4_bluecollar/gp4)*100,
g5_bluecollar = (g5_bluecollar/gp5)*100
)
View(data_sum)
xtable(data_sum)
data_sum <- data %>% filter(ubigeo %in% dist_vraem,
NOMAMBITO %in% c("AMBITO DE INTERVENCION DIRECTA",
"AMBITO DE INFLUENCIA")) %>%
filter(C5_P4_1 > 5 & C5_P4_1 <= 65) %>%
mutate(
g1 = ifelse(C5_P4_1>5 & C5_P4_1 <=10,1,0),
g2 = ifelse(C5_P4_1>10 & C5_P4_1 <=15,1,0),
g3 = ifelse(C5_P4_1>15 & C5_P4_1 <=20,1,0),
g4 = ifelse(C5_P4_1>20 & C5_P4_1 <=25,1,0),
g5 = ifelse(C5_P4_1>25 & C5_P4_1 <=35,1,0),
g6 = ifelse(C5_P4_1>35 & C5_P4_1 <=45,1,0),
g7 = ifelse(C5_P4_1>45 & C5_P4_1 <=55,1,0),
g8 = ifelse(C5_P4_1>55 & C5_P4_1 <=65,1,0),
g3_sec = ifelse(C5_P13_NIV == 4 & g3 == 1 & C5_P13_ANIO_SEC == 5,1,0),
g3_sup_in = ifelse(C5_P13_NIV == 6 & g3 == 1,1,0),
g3_sup_co = ifelse(C5_P13_NIV == 7 & g3 == 1,1,0),
g3_uni_in = ifelse(C5_P13_NIV == 8 & g3 == 1,1,0),
g3_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g3 == 1,1,0),
g4_sec = ifelse(C5_P13_NIV == 4 & g4 == 1 & C5_P13_ANIO_SEC == 5,1,0),
g4_sup_in = ifelse(C5_P13_NIV == 6 & g4 == 1,1,0),
g4_sup_co = ifelse(C5_P13_NIV == 7 & g4 == 1,1,0),
g4_uni_in = ifelse(C5_P13_NIV == 8 & g4 == 1,1,0),
g4_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10)  & g4 == 1,1,0),
g5_sec = ifelse(C5_P13_NIV == 4 & g5 == 1 & C5_P13_ANIO_SEC == 5,1,0),
g5_sup_in = ifelse(C5_P13_NIV == 6 & g5 == 1,1,0),
g5_sup_co = ifelse(C5_P13_NIV == 7 & g5 == 1,1,0),
g5_uni_in = ifelse(C5_P13_NIV == 8 & g5 == 1,1,0),
g5_uni_co = ifelse( (C5_P13_NIV == 9 | C5_P13_NIV == 10) & g5 == 1,1,0),
classification = case_when(substr(C5_P19_COD, 1, 1) %in% c("1","2") ~ 0,
substr(C5_P19_COD, 1, 1) %in% c("3","4","5","6","7","8","9") ~ 1,
substr(C5_P19_COD, 1, 2) %in% c("01") ~ 0,
substr(C5_P19_COD, 1, 2) %in% c("02", "03")  ~ 1),
g3_bluecollar =  ifelse(classification == 1 & g3 == 1,1,0),
g4_bluecollar =  ifelse(classification == 1 & g4 == 1,1,0),
g5_bluecollar =  ifelse(classification == 1 & g5 == 1,1,0),
)  %>%  group_by(NOMAMBITO) %>%
summarise(
pop = n(), gp1 = sum(g1), gp2 = sum(g2),gp3 = sum(g3),
gp4 = sum(g4),gp5 = sum(g5),gp6 = sum(g6),gp7 = sum(g7),gp8 = sum(g8),
g3_sec = sum(g3_sec), g3_sup_in = sum(g3_sup_in), g3_sup_co = sum(g3_sup_co),
g3_uni_in = sum(g3_uni_in), g3_uni_co = sum(g3_uni_co),
g4_sec = sum(g4_sec), g4_sup_in = sum(g4_sup_in), g4_sup_co = sum(g4_sup_co),
g4_uni_in = sum(g4_uni_in), g4_uni_co = sum(g4_uni_co),
g5_sec = sum(g5_sec), g5_sup_in = sum(g5_sup_in), g5_sup_co = sum(g5_sup_co),
g5_uni_in = sum(g5_uni_in), g5_uni_co = sum(g5_uni_co),
g3_bluecollar = sum( g3_bluecollar,na.rm=TRUE),
g4_bluecollar = sum( g4_bluecollar,na.rm=TRUE),
g5_bluecollar = sum( g5_bluecollar,na.rm=TRUE)
) %>%
mutate(
percent_gp1 = (gp1/pop)*100,
percent_gp2 = (gp2/pop)*100,
percent_gp3 = (gp3/pop)*100,
percent_gp4 = (gp4/pop)*100,
percent_gp5 = (gp5/pop)*100,
percent_gp6 = (gp6/pop)*100,
percent_gp7 = (gp7/pop)*100,
percent_gp8 = (gp8/pop)*100,
g3_sec = (g3_sec/gp3)*100, g3_sup_in = (g3_sup_in/gp3)*100, g3_sup_co = (g3_sup_co/gp3)*100,
g3_uni_in = (g3_uni_in/gp3)*100, g3_uni_co = (g3_uni_co/gp3)*100,
g4_sec = (g4_sec/gp4)*100, g4_sup_in = (g4_sup_in/gp4)*100, g4_sup_co = (g4_sup_co/gp4)*100,
g4_uni_in = (g4_uni_in/gp4)*100 , g4_uni_co = (g4_uni_co/gp4)*100,
g5_sec = (g5_sec/gp5)*100, g5_sup_in = (g5_sup_in/gp5)*100, g5_sup_co = (g5_sup_co/gp5)*100,
g5_uni_in = (g5_uni_in/gp5)*100, g5_uni_co = (g5_uni_co/gp5)*100,
g3_bluecollar = (g3_bluecollar/gp3)*100, g4_bluecollar = (g4_bluecollar/gp4)*100,
g5_bluecollar = (g5_bluecollar/gp5)*100
)
View(data_sum)
user <- Sys.getenv("USERNAME")  # username
setwd( paste0("C:/Users/",user,"/Documents/GitHub/1ECO35_2022_2/Lab7") ) # set directorio
enaho02_19 = data.frame(
read_dta("../../../datos/2020/737-Modulo02/737-Modulo02/enaho01-2020-200.dta")
)
enaho02_20 = data.frame(
read_dta("../../../datos/2019/687-Modulo02/687-Modulo02/enaho01-2019-200.dta")
)
data <-  bind_rows(enaho02_19, enaho02_20)
pacman::p_load(haven,dplyr, stringr)
"1.0 Set Directorio"
user <- Sys.getenv("USERNAME")  # username
setwd( paste0("C:/Users/",user,"/Documents/GitHub/1ECO35_2022_2/Lab7") ) # set directorio
enaho02_19 = data.frame(
read_dta("../../../datos/2020/737-Modulo02/737-Modulo02/enaho01-2020-200.dta")
)
enaho02_20 = data.frame(
read_dta("../../../datos/2019/687-Modulo02/687-Modulo02/enaho01-2019-200.dta")
)
data <-  bind_rows(enaho02_19, enaho02_20)
enaho02_19 <- enaho02_19[,-"codtarea"]
enaho02_19 <- enaho02_19[,-c("codtarea")]
enaho02_19 <- enaho02_19[-c("codtarea")]
enaho02_19 <- enaho02_19[-c(codtarea)]
enaho02_19 <- enaho02_19[,-c(codtarea)]
enaho02_19$codtarea <- NULL
data <-  bind_rows(enaho02_19, enaho02_20)
enaho02_19$codtiempo <- NULL
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
data <-  bind_rows(enaho02_19, enaho02_20)
data <-  bind_rows(enaho02_19, enaho02_20)
vlist <- sample(1:lenght(data)[1], lenght(data)[1]/2)
vlist <- sample(1:length(data)[1], length(data)[1]/2)
data_final <- data[vlist,seq(1, 20)]
View(data_final)
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso , NSELV, VIVIENDA, HOGAR) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
View(data_filtrada)
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
View(data_filtrada)
length(data)[1]
length(data)[0]
length(data)[2]
dim(data)
d
vlist <- sample(1:dim(data)[1], dim(data)[1]/2)
data_final <- data[vlist,seq(1, 20)]
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
View(data_filtrada)
data_filtrada <- data_filtrada[order(
data_filtrada$conglome,
data_filtrada$vivienda,
data_filtrada$hogar,
data_filtrada$codperso,
data_filtrada$aÑo
),]
View(data_filtrada)
pacman::p_load(haven,dplyr, stringr)
"1.0 Set Directorio"
user <- Sys.getenv("USERNAME")  # username
setwd( paste0("C:/Users/",user,"/Documents/GitHub/1ECO35_2022_2/Lab7") ) # set directorio
enaho02_19 = data.frame(
haven::read_sav("../../../datos/2020/737-Modulo02/737-Modulo02/enaho01-2020-200.sav")
)
View(enaho02_19)
enaho02_20 = data.frame(
haven::read_sav("../../../datos/2019/687-Modulo02/687-Modulo02/enaho01-2019-200.sav")
)
data <-  bind_rows(enaho02_19, enaho02_20)
enaho02_19$codtarea <- NULL
enaho02_19$codtiempo <- NULL
data <-  bind_rows(enaho02_19, enaho02_20)
enaho02_19$CODTAREA <- NULL
enaho02_19$CODTIEMPO <- NULL
data <-  bind_rows(enaho02_19, enaho02_20)
dim(data)[1]
vlist <- sample(1:dim(data)[1], dim(data)[1]/2)
data_final <- data[vlist,seq(1, 20)]
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
data_filtrada <- data_filtrada[order(
data_filtrada$conglome,
data_filtrada$vivienda,
data_filtrada$hogar,
data_filtrada$codperso,
data_filtrada$aÑo
),]
order
data_filtrada <- data_final %>% group_by(conglome ,vivienda , hogar , codperso ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
data_filtrada <- data_final %>% group_by(CONGLOME ,VIVIENDA, HOGAR , CODPERSO ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
vlist <- sample(1:dim(data)[1], dim(data)[1]/3)
data_final <- data[vlist,seq(1, 20)]
data_filtrada <- data_final %>% group_by(CONGLOME ,VIVIENDA, HOGAR , CODPERSO ) %>%
mutate(duplicates = n()) %>% filter(duplicates >1)
View(data_final)
write_sav(data_final , "../data/enapres_2020_ch_100/736-Modulo1618/data_administrativa.sav")
data_final <- data_final %>% rename(year= AÑO)
write_sav(data_final , "../data/enapres_2020_ch_100/736-Modulo1618/data_administrativa.sav")
